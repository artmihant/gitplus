# GitPlus

Небольшой CLI‑скрипт для автоматизации типового цикла коммита в Git‑репозитории:

- добавление всех изменённых и новых файлов в индекс;
- автоматическое управление версией в файле `VERSION`;
- формирование сообщения коммита (из аргументов или из `CHANGELOG.md`);
- создание коммита одной командой.

## Как это работает

Скрипт `gitplus.py` автоматически определяет один из двух сценариев работы:

### Сценарий (a): Быстрый коммит (Fallback)

Этот сценарий запускается, если:
- Передан аргумент командной строки с текстом сообщения.
- Либо файл `CHANGELOG.md` отсутствует, поврежден или не содержит блока `[actual]`.

**Действия:**
1. Инкрементирует версию в файле `VERSION`.
2. Формирует коммит с сообщением вида:
   ```text
   1.2.3 [2025-02-10 14:50:46]: сообщение из аргумента
   ```

### Сценарий (b): Коммит через Changelog

Этот сценарий запускается, если файл `CHANGELOG.md` существует и содержит заголовок с меткой `[actual]`.

**Действия:**
1. Парсит `CHANGELOG.md`, находя блок изменений, помеченный как `[actual]`.
   Пример заголовка: `## 1.2.3 - [2025-02-10 14:50:46] [actual]`
2. Извлекает версию из заголовка и обновляет файл `VERSION` (перезаписывает его значением из лога).
3. Формирует сообщение коммита из текста под заголовком (до следующего заголовка).
4. Удаляет метку `[actual]` из `CHANGELOG.md`, фиксируя изменения.

## Требования

- Python 3.7+ (рекомендуется актуальная 3.x);
- установленный `git`;
- библиотека `GitPython`.

Установка зависимости:

```bash
pip install gitpython
```

## Использование

Запускайте скрипт **из любой вложенной директории** внутри репозитория.

### Вариант 1: Прямой коммит (Сценарий A)

Просто передайте сообщение коммита в аргументе:

```bash
python gitplus.py "Исправил обработку ошибок"
```

### Вариант 2: Через Changelog (Сценарий B)

1. Отредактируйте `CHANGELOG.md`, добавив новый блок версии с меткой `[actual]`.
   
   ```markdown
   ## 1.2.4 - [2025-02-10 15:00:00] [actual]
   
   ### Исправлено
   * Критическая ошибка в модуле X
   ```

2. Запустите скрипт без аргументов:

   ```bash
   python gitplus.py
   ```

Скрипт автоматически найдет блок `[actual]`, закоммитит изменения с этим текстом и обновит версию.

## Правила для ИИ

Если вы — ИИ-ассистент, работающий над проектом с этим инструментом, следуйте правилам:

1. **Запись изменений:** После выполнения блока работ вы должны либо записать изменения в текущий `[actual]` блок файла `CHANGELOG.md`, либо создать новый `[actual]` блок.
2. **Версионирование:** Для создания нового блока считайте текущую версию из файла `VERSION`, инкрементируйте её и используйте в заголовке нового блока.
3. **Запрет на Git:** ИИ ни в коем случае **не должен запускать git или этот скрипт (gitplus.py)** самостоятельно. Контроль над выполнением коммитов (запуск скрипта) остается исключительно за пользователем.
